<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
    xmlns:py="http://genshi.edgewall.org/"
    xmlns:xi="http://www.w3.org/2001/XInclude">

<xi:include href="master.html" />

<head>
    <meta content="text/html; charset=UTF-8" http-equiv="content-type" py:replace="''"/>
    <title>Bisque login</title>
    <link rel="stylesheet" type="text/css" href="${tg.url('/client_service/public/css/login.css')}" />
</head>

<script type="text/javascript">


function redirect_login (login) {
    document.location  = ${providers_json} [ login ] ;
}

</script>


<body>

<div id="loginform" class="login">

<form action="${tg.url('/auth_service/login_handler', came_from = came_from.encode('utf-8'), __logins = login_counter.encode('utf-8'))}" method="POST" id='login_form' class="loginfields">

    <h2>Log-in</h2>  

    <div class="local" py:if="'local' in providers" >
        <h2>Local users</h2>        
        <label for="loginusername">Username:<input type="text" id="loginusername" name="login" value="$username" class="text"></input></label>
        <label for="loginpassword">Password:<input type="password" id="loginpassword" name="password" class="text"></input></label>
        <input type="submit" id="submit" value="Log-in" />
        
        <div class="registration">
            <p><a href="/registration/">Register local user</a></p>
            <p><a href="/registration/lost_password">Reset local password</a></p>
        </div>
    </div>
    
    <div class="remote" py:if="len(providers)>1 or 'local' not in providers">
        <h2>External providers</h2>
        <input py:if="'cas' in providers" type="button" id="submit_cas" value="Login with CAS" onclick="redirect_login('cas')" />
        <input py:if="'google' in providers" type="button" id="submit_google" value="Login with Google" onclick="redirect_login('google')" />
    </div>    
</form>


</div>

</body>
</html>
